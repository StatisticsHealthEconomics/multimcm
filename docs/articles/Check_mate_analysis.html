<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkmate 067 study Bayesian mixture cure model analysis • rstanbmcm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Checkmate 067 study Bayesian mixture cure model analysis">
<meta property="og:description" content="rstanbmcm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstanbmcm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Check_mate_analysis.html">Checkmate 067 study Bayesian mixture cure model analysis</a>
    </li>
    <li>
      <a href="../articles/how_to_use.html">How to use rstanbmcm</a>
    </li>
    <li>
      <a href="../articles/joint_event_times.html">Joint event time Bayesian mixture cure model</a>
    </li>
    <li>
      <a href="../articles/Simulating_trial_data.html">Simulating trial survival analysis data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Check_mate_analysis_files/header-attrs-2.5/header-attrs.js"></script><link href="Check_mate_analysis_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Check_mate_analysis_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Checkmate 067 study Bayesian mixture cure model analysis</h1>
                        <h4 class="author">Nathan Green, Gianluca Baio, UCL</h4>
            
            <h4 class="date">02 April, 2021</h4>
      
      
      <div class="hidden name"><code>Check_mate_analysis.Rmd</code></div>

    </div>

    
    
<div id="executive-summary" class="section level3">
<h3 class="hasAnchor">
<a href="#executive-summary" class="anchor"></a>Executive summary</h3>
<p>In this project we formulate and demonstrate the application of a Bayesian mixture cure model (MCM) using the Checkmate 067 study dataset for a range of survival distributions. Analogous results to those created previously for the frequentist MCM approach are produced and we extend the Bayesian MCM to incorporate additional structure. This includes modelling the cure fractions separately for OS and PFS (as in the frequentist approach) and by joining the overall survival (OS) and progression-free survival (PFS) models using a hierarchical (multilevel) structure on the cure fraction. We show that the Exponential and in particular the log-logistic OS and PFS Bayesian MCMs perform reasonably well for the Checkmate 067 data. We also perform a sensitivity analysis by increasing the background hazard rate via a hazard ratio adjustment, representing a study population with a higher mortality rate than the general population. The real benefit of this approach, not full explored in this analysis, may be with other dataset where there is relatively short follow-up or small sample sizes. The associated R code for this work, held in a private on-line repository, has been written for re-use and generalisability to other problems.</p>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Immuno-oncologic (IO) studies for melanoma therapies, such as <em>ipilimumab</em> (<code>ipi</code>), <em>nivolumab</em> (<code>nivo</code>), and the <em>nivolumab</em> with <em>ipilimumab</em> (<code>nivo + ipi</code>) combination, have indicated that survival curves “plateau” (a considerable proportion of patients are “long-term survivors”). Cure models are a special type of survival analysis where this “cure fraction” (the underlying proportion of responders to treatment/long-term survivors) is accounted for. Cure models estimate the cure fraction, in addition to a parametric survival function for patients that are not cured. The mortality risk in the cured patients is informed by a background mortality rate. The population that is not cured is subject both to background mortality and to additional mortality from their cancer, estimated using a parametric survival model.</p>
<p>A mixture cure model (MCM) (<span class="citation">Amico and Van Keilegom (2018)</span>) is a type of cure model where survival is modelled as a mixture of two groups of patients: those who are cured and those who are not (and who therefore remain at risk). The survival for a population with a cure fraction can be written as follows:</p>
<span class="math display">\[\begin{align}
\tag{*}
S(t, x) = S^*(t, x)[\pi(x) + (1 − \pi(x))S_u(t, x)],
\end{align}\]</span>
<p>where <span class="math inline">\(S(t, x)\)</span> denotes the survival at time <span class="math inline">\(t\)</span>, <span class="math inline">\(S^*(t, x)\)</span> denotes the background mortality at time <span class="math inline">\(t\)</span> conditional on covariates <span class="math inline">\(x\)</span>, <span class="math inline">\(\pi(x)\)</span> denotes the probability of being cured conditional on covariates <span class="math inline">\(x\)</span>, and <span class="math inline">\(S_u(t, x)\)</span> denotes the event (progression or mortality) due to cancer at time <span class="math inline">\(t\)</span> conditional on covariates <span class="math inline">\(x\)</span>. For PFS, the survival is composed of either progressing to a disease state or death.</p>
</div>
<div id="aims" class="section level2">
<h2 class="hasAnchor">
<a href="#aims" class="anchor"></a>Aims</h2>
<p>The aims of the the analysis in this document are as follows:</p>
<ul>
<li>Demonstrate the application of a Bayesian mixture cure model using the Checkmate 067 study dataset and the Exponential distribution for event times.</li>
<li>Produce analogous results to those created previously for the frequentist approach.</li>
<li>Extend the Bayesian model to incorporate additional structure including a hierarchical cure fraction.</li>
</ul>
<p>This analysis has been carried-out using the Stan inference engine (<span class="citation">Carpenter et al. (2017)</span>) called from R on a Windows PC. The packaged code can be downloaded from a private GitHub repository with permission from the package authors at <a href="https://github.com/StatisticsHealthEconomics/rstanbmcm" class="uri">https://github.com/StatisticsHealthEconomics/rstanbmcm</a>. See the <em>How to use rstanbmcm</em> vignette for an introduction to how to use the package.</p>
</div>
<div id="likelihood" class="section level2">
<h2 class="hasAnchor">
<a href="#likelihood" class="anchor"></a>Likelihood</h2>
<p>Let <span class="math inline">\(T_i\)</span> be the non-negative random variable denoting the survival time of patient <span class="math inline">\(i\)</span> with covariate vector <span class="math inline">\(\boldsymbol{x}_i\)</span>.</p>
<p>In the simplest case we can assume that the cure fraction is the same for the whole population i.e. <span class="math inline">\(\pi\)</span> is fixed. Further, we can assume the <span class="math inline">\(\pi\)</span> models the relationship between <span class="math inline">\(\boldsymbol{x}_i\)</span> and the probability of being cured. E.g. using a logistic-linear model</p>
<p><span class="math display">\[
\pi(\boldsymbol{x}_i | \boldsymbol{\beta}) = 1/[1 + \exp(-\boldsymbol{x}_i^T \boldsymbol{\beta})].
\]</span></p>
<p>The likelihood of the standard survival is</p>
<p><span class="math display">\[
L = \prod_i S(t_i | \boldsymbol{x}_i) h(t_i | \boldsymbol{x}_i)^{\delta_i}
\]</span></p>
<p>Log-likelihood is therefore <span class="math display">\[
\mathcal{l} = \sum_i \log(S(t_i | \boldsymbol{x}_i)) + \delta_i \log(h(t_i | \boldsymbol{x}_i))
\]</span></p>
<p>Plugging this directly into the mixture cure equation in (*) gives</p>
<p><span class="math display">\[
\mathcal{l}(\pi | \boldsymbol{\delta}, \boldsymbol{x}) =
 \sum_i \log(S^*(t_i | \boldsymbol{x}_i) h^*(t_i | \boldsymbol{x}_i)^{\delta_i}[\pi(x) +
   (1 − \pi(x)) S_u(t_i | \boldsymbol{x}_i) h_u(t_i | \boldsymbol{x}_i)^{\delta_i}])
\]</span></p>
<p>If we assume that the cured component is the Exponential survival model then the non-cured component can be thought of in similar terms to the cumulative incidence function. That is, the probability of an event is the combined probability of surviving both events (e.g. for OS, all-cause and cancer mortality) and then experiencing either i.e. dropping the <span class="math inline">\(S\)</span> dependencies for brevity</p>
<span class="math display">\[\begin{equation}
\tag{**}
S^* S_u (h^*)^{\delta} + S^* S_u (h_u)^{\delta} = S^* S_u (h^* + h_u)^{\delta}
\end{equation}\]</span>
</div>
<div id="bayesian-formulation" class="section level2">
<h2 class="hasAnchor">
<a href="#bayesian-formulation" class="anchor"></a>Bayesian formulation</h2>
<p>In a Bayesian approach to modelling (<span class="citation">McElreath (2018)</span>), all quantities that are subject to uncertainty are modelled using probability distributions. This applies to observed data (e.g. time to PFS for a given individual), that are subject to sampling variability, as well as to unobservable parameters (e.g. the coefficient quantifying the impact of age or sex over the average survival curve). In this latter case, probability distributions are used to model the epistemic uncertainty (e.g. the fact that we do not know for certain what the “true” underlying value of the model parameter is). In addition, we may model as yet unobserved (but potentially observable) quantities using a suitable probability model. For example, we could consider the extrapolated part of the survival curve as subject to uncertainty due to the current sampling process giving rise to the data that are actually observed, as well as the uncertainty on the underlying data generating process.</p>
<p>We can mix different sources of evidence to form our “prior” distributions, which are used to describe the state of science on the model parameters. These are then combined with any observed data to form an updated level of knowledge. This process is particularly relevant in the case at hand, when data can only inform about limited aspects of the overall underlying reality. For this reason, it is important to a) include information/evidence available in the form of external data and/or expert opinion; b) extract the most information possible from the available data (e.g. by formally trying to model the correlation between the PFS and the OS data to borrow strength from the more mature set of observations).</p>
<p>A built-in advantage of the Bayesian procedure is that uncertainty is directly and formally propagated to an economic model; the main output from the statistical analysis (the extrapolated survival curve) are produced by default as based on a full posterior distribution. From this, we can easily derive a “base case” (e.g. taking the mean value) but without the need for further tools (such as bootstrap) we already have a full characterisation of the underlying uncertainty that can be used in the process of probabilistic sensitivity analysis. We can moreover add information in the priors to ensure that the extrapolation beyond the observed data is realistic and consistent with the clinical expertise (e.g. by “anchoring” the extrapolated survival curve to be probabilistically below the curves for the healthy population, or by ensuring that OS behaves in a way to respect some agreed level of similarity, or correlation, to PFS).</p>
<div id="posterior-equation" class="section level4">
<h4 class="hasAnchor">
<a href="#posterior-equation" class="anchor"></a>Posterior equation</h4>
<p>Using the likelihood function defined above and prior distributions on uncertain parameters, we can specify the posterior distribution. Defining <span class="math inline">\(g_2\)</span> as the prior distribution for the coefficients of the uncured fraction <span class="math inline">\(\beta^u\)</span> and <span class="math inline">\(g_3\)</span> as the prior distribution for the coefficients of the cured fraction <span class="math inline">\(\beta^*\)</span>, then the general form of the posterior distribution can be written as follows.</p>
<p><span class="math display">\[
p(\pi, \boldsymbol{\beta^u}, \boldsymbol{\beta^*} | \boldsymbol{\delta}, \boldsymbol{x}) \propto
L(\pi, \boldsymbol{\beta^u}, \boldsymbol{\beta^*} | \boldsymbol{\delta}, \boldsymbol{x}) f(\pi) g_2(\boldsymbol{\beta^u}) g_3(\boldsymbol{\beta^*})
\]</span></p>
<p>assuming that the cure fraction is independent of the covariates.</p>
</div>
<div id="cure-fraction" class="section level3">
<h3 class="hasAnchor">
<a href="#cure-fraction" class="anchor"></a>Cure fraction</h3>
<p>There are two obvious ways to represent the uncertainty about the cure fraction in the model.</p>
<p>The first is to specify the cure fraction directly using a <span class="math inline">\(\pi \sim Beta(a_{cf}, b_{cf})\)</span> prior, most uninformative as a uniform <span class="math inline">\(Beta(1,1)\)</span>. The parameters can be obtained via transformation of mean and standard deviation to allow a more natural scale for elicitation.</p>
<p>Alternatively, we may specify the uncertainty on the real line with a Normal distribution and then transform to the probability scale.</p>
<p>A further consideration is how to represent the cure fraction so to share information between the OS and PFS data. We will investigate 3 alternatives.</p>
<ul>
<li>
<em>Pooled</em>: Assume that the cure fraction is the same for OS and PFS i.e. <span class="math inline">\(\pi_{os} = \pi_{os} = \pi\)</span> where <span class="math display">\[
logit(\pi) \sim N(\mu_{cf}, \sigma_{cf}^2), \;\;
\]</span>
</li>
<li>
<em>Separate</em>: Model each independently. <span class="math display">\[
logit(\pi_{os}) \sim N(\mu_{cfos}, \sigma_{cfos}^2), \;\;  
logit(\pi_{pfs}) \sim N(\mu_{cfpfs}, \sigma_{cfpfs}^2)  
\]</span>
</li>
<li>
<em>Hierarchical</em>: Assume exchangeability between OS and PFS<span class="math display">\[
\pi \sim N(\mu_{cf}, \sigma_{cf}^2), \;\;  
logit(\pi_{os}) \sim N(\pi, \sigma_{cfos}^2), \;\;  
logit(\pi_{pfs}) \sim N(\pi, \sigma_{cfpfs}^2)  
\]</span>
</li>
</ul>
<p>Below is an example DAG for the hierarchical cure fraction without a joint time to event component. Notice that even without the direct relationship between PFS and OS there is still an indirect influence via <span class="math inline">\(\pi\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="hierarchical_DAG.png" alt="\label{fig:hier_dag} Hierarchical cure fraction DAG." width="40%"><p class="caption">
 Hierarchical cure fraction DAG.
</p>
</div>
</div>
</div>
<div id="background-survival" class="section level2">
<h2 class="hasAnchor">
<a href="#background-survival" class="anchor"></a>Background survival</h2>
<p>The previous frequentist analysis used the World Health Organization (WHO) life tables by country for the latest year available of 2016 (<span class="citation">WHO (2020)</span>) to inform the background mortality rate (baseline hazard). These baseline hazards are the expected mortality rate for each patient at the age at which they experience the event. The mortality data are age- and gender adjusted, thus providing a granular account of the different patient profiles in the trial. The WHO reports conditional probabilities of death in 5-year intervals until age 85. A constant annual mortality rate is reported for individuals over 85. They assumed that the maximum age is 100 years.</p>
<p>In a Bayesian analysis there are alternative ways in which we could model the background mortality.</p>
<p>For this work we shall use WHO hazard point estimates as known. We could consider the WHO estimates to provide sufficiently accurate estimates given the sample size and so incorporating uncertainty is not necessary. This also forces consistency across fits. Denote the WHO estimates for individual <span class="math inline">\(i\)</span> as <span class="math inline">\(\hat{f}_i, \hat{S}_i, \hat{h}_i\)</span> for the density, survival and hazard respectively.</p>
<p>This gives the likelihood</p>
<p><span class="math display">\[
L(\pi | \boldsymbol{\delta}, \boldsymbol{x}, \hat{S}, \hat{h}) =
\sum_i \hat{S}_i \hat{h}_i^{\delta_i} \left[ \pi(x) + (1 - \pi(x)) S_{u, i} h_{u , i}^{\delta_i} \right]
\]</span></p>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<p>We fit the separate and exchangeable cure fraction models to the study data and produced the posterior survival curves below.</p>
<p>For each model and treatment we produce the expected survival curves with 95% Credible Intervals (CrI). The OS curves are to the left-hand side and PFS curves to the right-hand side. Background mortality (i.e. cured patients) is indicated by the red line. Non-cured patients survival curves are shown in dark green and blue for OS and PFS respectively. Light green and magenta are the total sample. The black line is the Kaplan-Meier curve for the observed data. Note that these plots are for an average individual, e.g. at average age, and so we would not expect them to perfectly match the sample data Kaplan-Meier.</p>
<div id="separate-survival-models-for-os-and-pfs" class="section level3">
<h3 class="hasAnchor">
<a href="#separate-survival-models-for-os-and-pfs" class="anchor"></a>Separate survival models for OS and PFS</h3>
<p>Figures , , and  show posterior survival curves for the Exponential, log-logistic, Gompertz, Weibull and log-Normal models when the OS and PFS models are fitted separately.</p>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-3-1.png" alt="\label{fig:IPI_separate}Posterior survival curves for the mixture cure model for separate OS and PFS models and $ipilimumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model for separate OS and PFS models and <span class="math inline">\(ipilimumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-4-1.png" alt="\label{fig:NIVO_separate}Posterior survival curves for the mixture cure model for separate OS and PFS models and $nivolumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model for separate OS and PFS models and <span class="math inline">\(nivolumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-5-1.png" alt="\label{fig:NIVO+IPI_separate}Posterior survival curves for the mixture cure model for separate OS and PFS models and $ipilimumab$ and $nivolumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model for separate OS and PFS models and <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<p>Figures  and  show the forest plots of cure fraction posterior distributions.</p>
<div class="figure" style="text-align: center">
<img src="../plots/cf%20separate_os_forest_plot.png" alt="\label{fig:forest_os_separate}Forest plot of OS cure fraction posterior distributions for separate OS and PFS models ." width="60%"><p class="caption">
Forest plot of OS cure fraction posterior distributions for separate OS and PFS models .
</p>
</div>
<div class="figure" style="text-align: center">
<img src="../plots/cf%20separate_pfs_forest_plot.png" alt="\label{fig:forest_pfs_separate}Forest plot of PFS cure fraction posterior distributions for separate OS and PFS models ." width="60%"><p class="caption">
Forest plot of PFS cure fraction posterior distributions for separate OS and PFS models .
</p>
</div>
<table class="table">
<colgroup>
<col width="3%">
<col width="13%">
<col width="13%">
<col width="23%">
<col width="23%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">
<span class="math inline">\(cf_{OS}\)</span> (CrI)</th>
<th align="left">
<span class="math inline">\(cf_{PFS}\)</span> (CrI)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.216 (0.16, 0.271)</td>
<td align="left">0.128 (0.089, 0.173)</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.417 (0.335, 0.482)</td>
<td align="left">0.32 (0.268, 0.37)</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.509 (0.43, 0.573)</td>
<td align="left">0.387 (0.332, 0.441)</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.221 (0.176, 0.282)</td>
<td align="left">0.126 (0.092, 0.156)</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.414 (0.352, 0.477)</td>
<td align="left">0.321 (0.274, 0.383)</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.51 (0.447, 0.575)</td>
<td align="left">0.39 (0.323, 0.457)</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.183 (0.11, 0.265)</td>
<td align="left">0.13 (0.091, 0.168)</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.329 (0.217, 0.423)</td>
<td align="left">0.321 (0.267, 0.381)</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.449 (0.349, 0.524)</td>
<td align="left">0.359 (0.308, 0.427)</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.304 (0.241, 0.378)</td>
<td align="left">0.175 (0.13, 0.207)</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.477 (0.432, 0.531)</td>
<td align="left">0.424 (0.375, 0.467)</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.55 (0.487, 0.611)</td>
<td align="left">0.411 (0.365, 0.459)</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.238 (0.177, 0.285)</td>
<td align="left">0.146 (0.105, 0.186)</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.425 (0.348, 0.51)</td>
<td align="left">0.317 (0.261, 0.378)</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.504 (0.423, 0.566)</td>
<td align="left">0.392 (0.339, 0.45)</td>
</tr>
</tbody>
</table>
<p>The table below gives the leave-one-out cross validation statistics for each model fit using WAIC (<span class="citation">Vehtari, Gelman, and Gabry (2017)</span>).</p>
<table class="table">
<thead><tr class="header">
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">Statistic</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1548.19</td>
<td align="right">53.04</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic.1</td>
<td align="right">-1548.57</td>
<td align="right">53.21</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic.2</td>
<td align="right">-1541.23</td>
<td align="right">52.74</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic.3</td>
<td align="right">-1487.44</td>
<td align="right">57.45</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic.4</td>
<td align="right">-1549.41</td>
<td align="right">53.59</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">6.05</td>
<td align="right">0.61</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic.1</td>
<td align="right">6.59</td>
<td align="right">0.53</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic.2</td>
<td align="right">7.69</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic.3</td>
<td align="right">14.76</td>
<td align="right">1.22</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic.4</td>
<td align="right">7.92</td>
<td align="right">0.72</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3096.38</td>
<td align="right">106.09</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.1</td>
<td align="right">3097.14</td>
<td align="right">106.41</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic.2</td>
<td align="right">3082.45</td>
<td align="right">105.49</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic.3</td>
<td align="right">2974.89</td>
<td align="right">114.90</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.4</td>
<td align="right">3098.82</td>
<td align="right">107.17</td>
</tr>
</tbody>
</table>
</div>
<div id="exchangeable-cure-fraction-for-os-and-pfs" class="section level3">
<h3 class="hasAnchor">
<a href="#exchangeable-cure-fraction-for-os-and-pfs" class="anchor"></a>Exchangeable cure fraction for OS and PFS</h3>
<p>Figures , , and  show posterior survival curves for the Exponential, log-logistic, Gompertz, Weibull and log-Normal models when the OS and PFS models share information with exchangeable cure fractions.</p>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-8-1.png" alt="\label{fig:IPI}Posterior survival curves for the mixture cure model with exchangeable cure fracion and $ipilimumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model with exchangeable cure fracion and <span class="math inline">\(ipilimumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-9-1.png" alt="\label{fig:NIVO}Posterior survival curves for the mixture cure model with exchangeable cure fracion and $nivolumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model with exchangeable cure fracion and <span class="math inline">\(nivolumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-10-1.png" alt="\label{fig:NIVO+IPI}Posterior survival curves for the mixture cure model with exchangeable cure fracion and dual $ipilimumab$ and $nivolumab$. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model with exchangeable cure fracion and dual <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span>. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<p>Figures ,  and  show the forest plots of cure fraction posterior distributions. We see that the values are generally similar for the Exponential and log-logistic fits. This clearly shows how the global cure fraction posterior distribution lies partway between the PFS and OS distributions.</p>
<div class="figure" style="text-align: center">
<img src="../plots/cf_global_forest_plot.png" alt="\label{fig:forest_global}Forest plot of global cure fraction posterior distributions." width="60%"><p class="caption">
Forest plot of global cure fraction posterior distributions.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="../plots/cf_os_forest_plot.png" alt="\label{fig:forest_os}Forest plot of OS cure fraction posterior distributions." width="60%"><p class="caption">
Forest plot of OS cure fraction posterior distributions.
</p>
</div>
<div class="figure" style="text-align: center">
<img src="../plots/cf_pfs_forest_plot.png" alt="\label{fig:forest_pfs}Forest plot of PFS cure fraction posterior distributions." width="60%"><p class="caption">
Forest plot of PFS cure fraction posterior distributions.
</p>
</div>
<p>The table below summarises the cure fraction posterior distribution for each scenario.</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="10%">
<col width="10%">
<col width="18%">
<col width="18%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">
<span class="math inline">\(cf\)</span> (CrI)</th>
<th align="left">
<span class="math inline">\(cf_{OS}\)</span> (CrI)</th>
<th align="left">
<span class="math inline">\(cf_{PFS}\)</span> (CrI)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.151 (0.068, 0.26)</td>
<td align="left">0.196 (0.136, 0.255)</td>
<td align="left">0.112 (0.079, 0.155)</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.378 (0.216, 0.557)</td>
<td align="left">0.412 (0.35, 0.479)</td>
<td align="left">0.321 (0.262, 0.379)</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.463 (0.328, 0.626)</td>
<td align="left">0.526 (0.452, 0.597)</td>
<td align="left">0.392 (0.334, 0.448)</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.164 (0.088, 0.275)</td>
<td align="left">0.207 (0.13, 0.266)</td>
<td align="left">0.114 (0.079, 0.148)</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.368 (0.247, 0.517)</td>
<td align="left">0.423 (0.358, 0.494)</td>
<td align="left">0.321 (0.261, 0.369)</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.458 (0.318, 0.612)</td>
<td align="left">0.529 (0.477, 0.594)</td>
<td align="left">0.395 (0.346, 0.446)</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.133 (0.061, 0.278)</td>
<td align="left">0.133 (0.054, 0.206)</td>
<td align="left">0.113 (0.075, 0.152)</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.348 (0.191, 0.526)</td>
<td align="left">0.345 (0.231, 0.456)</td>
<td align="left">0.325 (0.264, 0.382)</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.421 (0.266, 0.599)</td>
<td align="left">0.459 (0.37, 0.535)</td>
<td align="left">0.375 (0.327, 0.421)</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.236 (0.127, 0.303)</td>
<td align="left">0.285 (0.198, 0.468)</td>
<td align="left">0.177 (0.136, 0.293)</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.425 (0.286, 0.588)</td>
<td align="left">0.486 (0.431, 0.546)</td>
<td align="left">0.437 (0.39, 0.48)</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.431 (0.301, 0.581)</td>
<td align="left">0.556 (0.494, 0.619)</td>
<td align="left">0.42 (0.37, 0.481)</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">0.184 (0.095, 0.29)</td>
<td align="left">0.229 (0.157, 0.295)</td>
<td align="left">0.141 (0.107, 0.177)</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">0.375 (0.242, 0.541)</td>
<td align="left">0.427 (0.346, 0.494)</td>
<td align="left">0.326 (0.27, 0.394)</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.471 (0.328, 0.647)</td>
<td align="left">0.523 (0.461, 0.58)</td>
<td align="left">0.399 (0.35, 0.462)</td>
</tr>
</tbody>
</table>
<p>The table below gives the leave-one-out cross validation statistics for each model fit.</p>
<table class="table">
<thead><tr class="header">
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">Statistic</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1838.83</td>
<td align="right">36.07</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1679.59</td>
<td align="right">45.69</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1549.68</td>
<td align="right">60.15</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1488.81</td>
<td align="right">58.20</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1819.89</td>
<td align="right">39.69</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1680.25</td>
<td align="right">45.91</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1544.04</td>
<td align="right">54.19</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1543.49</td>
<td align="right">53.87</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1839.34</td>
<td align="right">36.27</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1679.48</td>
<td align="right">45.80</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1543.81</td>
<td align="right">54.03</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1768.17</td>
<td align="right">39.20</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1651.73</td>
<td align="right">46.02</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1533.95</td>
<td align="right">53.17</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1566.33</td>
<td align="right">55.91</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">5.37</td>
<td align="right">0.48</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic</td>
<td align="right">7.45</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">15.46</td>
<td align="right">1.44</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">14.55</td>
<td align="right">1.26</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic</td>
<td align="right">9.46</td>
<td align="right">0.96</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">8.70</td>
<td align="right">0.75</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">7.70</td>
<td align="right">0.72</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic</td>
<td align="right">7.15</td>
<td align="right">0.60</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">5.91</td>
<td align="right">0.52</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">6.96</td>
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic</td>
<td align="right">7.07</td>
<td align="right">0.78</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">9.19</td>
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">9.20</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">p_waic</td>
<td align="right">6.10</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">20.04</td>
<td align="right">1.20</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3677.65</td>
<td align="right">72.13</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3359.19</td>
<td align="right">91.37</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3099.36</td>
<td align="right">120.30</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">2977.62</td>
<td align="right">116.41</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3639.77</td>
<td align="right">79.38</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3360.49</td>
<td align="right">91.83</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3088.08</td>
<td align="right">108.39</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3086.98</td>
<td align="right">107.74</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3678.68</td>
<td align="right">72.53</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3358.96</td>
<td align="right">91.59</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3087.62</td>
<td align="right">108.05</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3536.33</td>
<td align="right">78.40</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3303.47</td>
<td align="right">92.04</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="left">waic</td>
<td align="right">3067.91</td>
<td align="right">106.35</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3132.66</td>
<td align="right">111.82</td>
</tr>
</tbody>
</table>
<p>The variance partition coefficient (VPC) is defined as <span class="math inline">\(\sigma_{global}^2/ (\sigma_{global}^2 + \sigma_{e}^2)\)</span> where <span class="math inline">\(e = PFS\)</span> or <span class="math inline">\(OS\)</span>. This indicates want proportion of the total variance is attributable to variation within-groups, or how much is found between-groups.</p>
<table class="table">
<thead><tr class="header">
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="right">PFS</th>
<th align="right">OS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">IPILIMUMAB</td>
<td align="right">0.813</td>
<td align="right">0.784</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB</td>
<td align="right">0.876</td>
<td align="right">0.877</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="right">0.865</td>
<td align="right">0.860</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">IPILIMUMAB</td>
<td align="right">0.781</td>
<td align="right">0.743</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB</td>
<td align="right">0.858</td>
<td align="right">0.808</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="right">0.899</td>
<td align="right">0.888</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">IPILIMUMAB</td>
<td align="right">0.812</td>
<td align="right">0.604</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB</td>
<td align="right">0.890</td>
<td align="right">0.672</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="right">0.915</td>
<td align="right">0.786</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">IPILIMUMAB</td>
<td align="right">0.607</td>
<td align="right">0.513</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB</td>
<td align="right">0.928</td>
<td align="right">0.881</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="right">0.868</td>
<td align="right">0.862</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">IPILIMUMAB</td>
<td align="right">0.841</td>
<td align="right">0.726</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB</td>
<td align="right">0.865</td>
<td align="right">0.822</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="right">0.891</td>
<td align="right">0.863</td>
</tr>
</tbody>
</table>
<p>It appears the above table that much of the variation is due to between PFS and OS indicating distinct cure fractions in each.</p>
</div>
</div>
<div id="sensitivity-analysis-for-background-mortality" class="section level2">
<h2 class="hasAnchor">
<a href="#sensitivity-analysis-for-background-mortality" class="anchor"></a>Sensitivity analysis for background mortality</h2>
<p>As a sensitivity analysis, an adjustment factor was applied to the general population mortality rates to allow for an assessment of the impact of background hazards on estimation of the cure fraction. A hazard ratio of 1.63 was applied to the background hazard. This was obtained from a previous ad-hoc analysis which compared the WHO life tables with the OS data for complete responders (CR) from CheckMate 067 (N=120, pooled across all 3 arms).</p>
<p>Figure  shows the equivalent posterior survival curves to Figure  for the combined <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span> treatment and background hazard ratio adjustment 1.63. There is a small increase of approximately 1-2% in the cure fraction estimates.</p>
<div class="figure" style="text-align: center">
<img src="Check_mate_analysis_files/figure-html/unnamed-chunk-14-1.png" alt="\label{fig:NIVO+IPI_163}Posterior survival curves for the mixture cure model with exchangeable cure fracion and dual $ipilimumab$ and $nivolumab$ and background hazard ratio adjustment 1.63. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured." width="25cm" height="40cm"><p class="caption">
Posterior survival curves for the mixture cure model with exchangeable cure fracion and dual <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span> and background hazard ratio adjustment 1.63. The red line is cured background, light green and blue are uncured, and dark green and magenta are combined. a) Exponential uncured b) Log-logistic uncured c) Gompertz uncured d) Weibull uncured e) Log-Normal uncured.
</p>
</div>
<p>The table below summarises the cure fraction posterior distribution for each scenario.</p>
<table class="table">
<colgroup>
<col width="2%">
<col width="10%">
<col width="10%">
<col width="18%">
<col width="18%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">
<span class="math inline">\(cf\)</span> (CrI)</th>
<th align="left">
<span class="math inline">\(cf_{OS}\)</span> (CrI)</th>
<th align="left">
<span class="math inline">\(cf_{PFS}\)</span> (CrI)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.45 (0.291, 0.646)</td>
<td align="left">0.538 (0.473, 0.588)</td>
<td align="left">0.402 (0.351, 0.457)</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.459 (0.287, 0.616)</td>
<td align="left">0.541 (0.448, 0.6)</td>
<td align="left">0.409 (0.349, 0.474)</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.433 (0.287, 0.601)</td>
<td align="left">0.482 (0.374, 0.567)</td>
<td align="left">0.39 (0.324, 0.444)</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.46 (0.289, 0.648)</td>
<td align="left">0.583 (0.531, 0.643)</td>
<td align="left">0.434 (0.381, 0.491)</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">0.469 (0.297, 0.62)</td>
<td align="left">0.546 (0.496, 0.592)</td>
<td align="left">0.409 (0.354, 0.459)</td>
</tr>
</tbody>
</table>
<p>Figure  shows the equivalent posterior survival curves to Figures , ,  for the combined <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span> treatment and background hazard ratio adjustment 1.63.</p>
<div class="figure" style="text-align: center">
<img src="../plots/cf%20hier_bg_fixed_hr1.63_forest_plot.png" alt="\label{fig:forest_global_163}Forest plot of cure fraction posterior distributions for dual $ipilimumab$ and $nivolumab$ and background hazard ratio adjustment 1.63." width="60%"><p class="caption">
Forest plot of cure fraction posterior distributions for dual <span class="math inline">\(ipilimumab\)</span> and <span class="math inline">\(nivolumab\)</span> and background hazard ratio adjustment 1.63.
</p>
</div>
<p>The table below gives the leave-one-out cross validation statistics for each model fit.</p>
<table class="table">
<thead><tr class="header">
<th align="left">OS Distn</th>
<th align="left">PFS Distn</th>
<th align="left">Treatment</th>
<th align="left">Statistic</th>
<th align="right">Estimate</th>
<th align="right">SE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic</td>
<td align="right">-1548.19</td>
<td align="right">53.04</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic.1</td>
<td align="right">-1548.57</td>
<td align="right">53.21</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic.2</td>
<td align="right">-1541.23</td>
<td align="right">52.74</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic.3</td>
<td align="right">-1487.44</td>
<td align="right">57.45</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">elpd_waic.4</td>
<td align="right">-1549.41</td>
<td align="right">53.59</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic</td>
<td align="right">6.05</td>
<td align="right">0.61</td>
</tr>
<tr class="odd">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic.1</td>
<td align="right">6.59</td>
<td align="right">0.53</td>
</tr>
<tr class="even">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic.2</td>
<td align="right">7.69</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic.3</td>
<td align="right">14.76</td>
<td align="right">1.22</td>
</tr>
<tr class="even">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">p_waic.4</td>
<td align="right">7.92</td>
<td align="right">0.72</td>
</tr>
<tr class="odd">
<td align="left">exp</td>
<td align="left">exp</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic</td>
<td align="right">3096.38</td>
<td align="right">106.09</td>
</tr>
<tr class="even">
<td align="left">gompertz</td>
<td align="left">gompertz</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.1</td>
<td align="right">3097.14</td>
<td align="right">106.41</td>
</tr>
<tr class="odd">
<td align="left">loglogistic</td>
<td align="left">loglogistic</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.2</td>
<td align="right">3082.45</td>
<td align="right">105.49</td>
</tr>
<tr class="even">
<td align="left">lognormal</td>
<td align="left">lognormal</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.3</td>
<td align="right">2974.89</td>
<td align="right">114.90</td>
</tr>
<tr class="odd">
<td align="left">weibull</td>
<td align="left">weibull</td>
<td align="left">NIVOLUMAB+IPILIMUMAB</td>
<td align="left">waic.4</td>
<td align="right">3098.82</td>
<td align="right">107.17</td>
</tr>
</tbody>
</table>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Amico2018" class="csl-entry">
Amico, Maïlis, and Ingrid Van Keilegom. 2018. <span>“<span class="nocase">Cure Models in Survival Analysis</span>.”</span> <em>Annual Review of Statistics and Its Application</em> 5: 311–42. <a href="https://doi.org/10.1146/annurev-statistics-031017-100101">https://doi.org/10.1146/annurev-statistics-031017-100101</a>.
</div>
<div id="ref-carpenter2017stan" class="csl-entry">
Carpenter, Bob, Andrew Gelman, Matthew D Hoffman, Daniel Lee, Ben Goodrich, Michael Betancourt, Marcus Brubaker, Jiqiang Guo, Peter Li, and Allen Riddell. 2017. <span>“Stan: A Probabilistic Programming Language.”</span> <em>Journal of Statistical Software</em> 76 (1).
</div>
<div id="ref-McElreath2018" class="csl-entry">
McElreath, Richard. 2018. <em><span class="nocase">Statistical Rethinking: A Bayesian Course with Examples in R and Stan</span></em>. Chapman and Hall/CRC.
</div>
<div id="ref-Vehtari2017" class="csl-entry">
Vehtari, Aki, Andrew Gelman, and Jonah Gabry. 2017. <span>“<span class="nocase">Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC</span>.”</span> <em>Statistics and Computing</em> 27 (5): 1413–32. <a href="https://doi.org/10.1007/s11222-016-9696-4">https://doi.org/10.1007/s11222-016-9696-4</a>.
</div>
<div id="ref-wholifetables" class="csl-entry">
WHO. 2020. <span>“<span class="nocase">Life tables by country</span>.”</span> <a href="http://apps.who.int/gho/data/?theme=main&amp;vid=61160">http://apps.who.int/gho/data/?theme=main&amp;vid=61160</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nathan Green.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
